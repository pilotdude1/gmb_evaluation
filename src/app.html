<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<link rel="icon" type="image/svg+xml" href="%sveltekit.assets%/favicon.svg" />
	<link rel="icon" type="image/x-icon" href="%sveltekit.assets%/favicon.ico" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />

	<!-- PWA Meta Tags -->
	<!-- Apple-specific meta tags -->
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="default" />
	<meta name="apple-mobile-web-app-title" content="LocalSocialMax" />
	<meta name="mobile-web-app-capable" content="yes" />

	<!-- Microsoft-specific meta tags -->
	<meta name="msapplication-TileColor" content="#ffffff" />
	<meta name="msapplication-tap-highlight" content="no" />

	<!-- Theme Color Meta Tags -->
	<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff" />
	<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000000" />

	<!-- PWA Icons -->
	<link rel="apple-touch-icon" href="%sveltekit.assets%/apple-touch-icon.png" />
	<link rel="mask-icon" href="%sveltekit.assets%/masked-icon.svg" color="#ffffff" />

	<!-- PWA Manifest -->
	<link rel="manifest" href="/manifest.webmanifest" />

	<!-- Service Worker Registration handled by Vite PWA plugin -->
	
	<!-- Initialize PWA prompt listener early -->
	<script>
		// Initialize PWA prompt listener as early as possible
		if (typeof window !== 'undefined' && !import.meta.env.DEV) {
			let deferredInstallPrompt = null;
			
			window.addEventListener('beforeinstallprompt', (e) => {
				e.preventDefault();
				deferredInstallPrompt = e;
				console.log('PWA install prompt captured and deferred');
			});
			
			// Make the prompt available globally
			window.getDeferredInstallPrompt = () => deferredInstallPrompt;
			window.clearDeferredInstallPrompt = () => { deferredInstallPrompt = null; };
		}
	</script>

	<!-- Cross-browser theme color support -->
	<style>
		:root {
			--theme-color-light: #ffffff;
			--theme-color-dark: #000000;
		}

		/* Firefox and Opera theme color fallback */
		@supports (-moz-appearance: none) or (-o-appearance: none) {
			html {
				background-color: var(--theme-color-light);
			}

			@media (prefers-color-scheme: dark) {
				html {
					background-color: var(--theme-color-dark);
				}
			}
		}

		/* Ensure consistent theme color across all browsers */
		html {
			background-color: var(--theme-color-light);
		}

		@media (prefers-color-scheme: dark) {
			html {
				background-color: var(--theme-color-dark);
			}
		}
	</style>

	%sveltekit.head%
</head>

<body data-sveltekit-preload-data="hover">
	<div class="contents">%sveltekit.body%</div>

</body>

</html>